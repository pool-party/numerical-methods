# Домашнее задание 2

Для всех итерационных методов использовались критерии малости невязки ($\frac {\left \| Ax^k-b \right \|} {\left \| b \right \|} \le \epsilon$) и малости нормы разности двух последовательных приближений ($\frac {\left \| x^{k+1}-x^k \right \|} {\left \| x^k \right \|} \le \epsilon$), где $\epsilon = 0.000001$ и в качестве нормы используется 2-норма векторов.

Для всех методов максимальное количество итераций $maxIterations = 1,000,000$.

В методе Зайделя с релаксацией для всех матриц использовалось $\omega = 0.5$.

Для метода Якоби проверялось условие сходимости $\rho(D^{-1}R)<1$, где $\rho$ - спектральный радиус матрицы ($\rho(A)=max\{|\lambda_1|, ..., |\lambda_n|\}$, где $\lambda_1, ..., \lambda_n$ - собственные числа), $D$ - диагональная матрица, $R=A-D$. Это необходимо, так как на неподходящих под это условие матрицах невозможно было найти ответ в силу ограничений на операцию деления для типа float64 (после нескольких десятков итераций из-за деления на относительно маленькое число вектор $x$ ровнялся $[\infty, ..., \infty]$). Стоит отметить, что матрицы, которые не подходили под это условие, также не подходили под условие диагонального преобладания, которое является существенным (хоть и не необходимым) для сходимости метода Якоби.

$A_{symmetric}$ - матрица A и ее вектор b, домноженные слева на $A^T$.

$\mu(A)$ - число обусловленности.

Все результаты переведены из научной записи ($1e+1$) в десятичную.

### <u>Диагональная матрица</u>

Матрица хорошо обусловленная, т. к. $det(A_{diag}) \approx 79,649,555,832,435,952,568,192$, $\mu(A_{diag}) = \left \| A_{diag} \right \|*\left \| {A_{diag}}^{-1} \right \| = 13.329146508625698$

| $A$ |     |     |     |     |     |     |     |     |     |     |     | $b$ |
| --: | --: | --: | --: | --: | --: | --: | --: | --: | --: | --: | --: | --: |
|  73 |  -8 |  -1 |  -2 |   2 |  -9 |   3 |   1 | -10 |  -3 |   0 | -10 |  -6 |
|  -9 |  89 |  -1 |   0 |   8 |   3 |   7 |   6 | -10 |   7 |  -6 |   6 |   9 |
|  -2 |   0 |  79 |   7 |  -8 |   8 |   7 |   5 |   0 |   8 |  -4 |   8 |   6 |
|  -5 |  -5 |  -5 |  91 |  -8 |  -7 |  -3 |   8 |  -5 | -10 |   7 |   7 |   4 |
|   8 |  -8 |   3 |   3 |  90 |  -8 |  -5 |   7 |   7 |  -1 | -10 |   1 |   7 |
|  -3 | -10 |   7 |   8 |  -7 |  98 |  -5 |  -5 |   7 |  -3 | -10 |  -8 |  -3 |
|   4 |  -1 |  -9 | -10 |  -2 |  -1 |  73 |   3 |   0 |   7 |  -7 |   2 |  -2 |
|   9 |   2 |  -4 |  -7 |   5 | -10 | -10 |  92 |   7 |  -9 |  -2 |  -3 |  -4 |
|  -1 | -10 |  -1 | -10 | -10 |  -6 |   5 |  -4 |  87 |  -6 |   3 |  -2 |   4 |
|  -4 |  -6 |  -1 |   9 |  -6 | -10 |   8 |  -3 |  -8 |  86 |   2 |   1 |   2 |
|   1 |   1 |   5 |   4 |   7 |   9 |   6 |   3 |  -1 |   0 |  68 |   9 |   9 |
|   0 |   5 |   4 |   5 |  -1 |  -4 |  -1 |  -1 |   2 |  -4 |  -1 |  56 |   9 |

| $A_{symmetric}$ |       |      |       |       |       |       |       |       |       |      |      | $b$  |
| --------------: | ----: | ---: | ----: | ----: | ----: | ----: | ----: | ----: | ----: | ---: | ---- | ---- |
|            5702 | -1333 | -405 |  -446 |   806 | -1059 |   515 |   808 |  -759 |  -350 |  -74 | -592 | -629 |
|           -1333 |  8382 |  106 |  -473 |   -95 |  -776 |   497 |   454 | -1909 |   139 | -126 | 702  | 832  |
|            -405 |   106 | 6640 |   227 |  -502 |  1347 |  -155 |  -201 |  -176 |   689 |  294 | 735  | 452  |
|            -446 |  -473 |  227 |  8765 |  -423 |   -28 | -1157 |   144 | -1143 |   145 |  760 | 856  | 344  |
|             806 |   -95 | -502 |  -423 |  8535 | -1179 |  -468 |  1322 |  -283 |  -642 | -102 | 11   | 491  |
|           -1059 |  -776 | 1347 |   -28 | -1179 | 10147 |  -576 | -1436 |   106 | -1168 |   83 | -769 | -451 |
|             515 |   497 | -155 | -1157 |  -468 |  -576 |  5643 |  -369 |   427 |  1096 | -116 | -70  | -327 |
|             808 |   454 | -201 |   144 |  1322 | -1436 |  -369 |  8982 |   300 | -1230 |  -46 | -204 | -406 |
|            -759 | -1909 | -176 | -1143 |  -283 |   106 |   427 |   300 |  7997 | -1061 |  -63 | 12   | 169  |
|            -350 |   139 |  689 |   145 |  -642 | -1168 |  1096 | -1230 | -1061 |  7808 |   81 | -254 | 151  |
|             -74 |  -126 |  294 |   760 |  -102 |    83 |  -116 |   -46 |   -63 |    81 | 4924 | 427  | 736  |
|            -592 |   702 |  735 |   856 |    11 |  -769 |   -70 |  -204 |    12 |  -254 |  427 | 3242 | 595  |

###### Результаты:

| Метод                       | Точное решение |           Якоби |         Зайделя | Зайделя с релаксацией | Cопряжённых градиентов |      Гаусса |
| --------------------------- | -------------: | --------------: | --------------: | --------------------: | ---------------------: | ----------: |
| Количество итераций         |              - |              11 |               7 |                    25 |                     12 |           - |
| Критерий окончания итераций |              - | Малость невязки | Малость невязки |       Малость невязки |        Малость невязки |           - |
| $x_1$                       |    -0.04140748 |     -0.08219178 |     -0.08219178 |           -0.04109589 |            -0.04140747 | -0.04140748 |
| $x_2$                       |      0.0951535 |       0.1011236 |      0.09281207 |            0.04848392 |             0.09515349 |   0.0951535 |
| $x_3$                       |     0.07045395 |      0.07594937 |      0.07386856 |            0.03745448 |             0.07045396 |  0.07045395 |
| $x_4$                       |     0.04999145 |      0.04395604 |      0.04859829 |            0.02320996 |             0.04999148 |  0.04999145 |
| $x_5$                       |     0.09185645 |      0.07777778 |      0.08925145 |            0.04185914 |             0.09185645 |  0.09185645 |
| $x_6$                       |    -0.00910101 |     -0.03061224 |     -0.02652613 |           -0.01425151 |            -0.00910098 | -0.00910101 |
| $x_7$                       |    -0.00180436 |     -0.02739726 |     -0.00377595 |           -0.00786627 |            -0.00180429 | -0.00180436 |
| $x_8$                       |    -0.03653304 |     -0.04347826 |     -0.03869037 |           -0.02089832 |            -0.03653296 | -0.03653304 |
| $x_9$                       |     0.07336947 |      0.04597701 |      0.06900295 |             0.0287478 |             0.07336951 |  0.07336947 |
| $x_{10}$                    |     0.03064549 |      0.02325581 |      0.03024415 |            0.01333687 |             0.03064556 |  0.03064549 |
| $x_{11}$                    |     0.09893318 |      0.13235294 |      0.12128454 |            0.06387051 |             0.09893317 |  0.09893318 |
| $x_{12}$                    |      0.1443634 |      0.16071429 |      0.14361446 |            0.07596003 |              0.1443634 |   0.1443634 |

Вычисление метода сопряженных градиентов и метода Гаусса выполнялось на симметричной матрице, остальные методы были вычислены на изначальное матрице.

### <u>Случайная матрица с выборкой [0,1)</u>

$det(A_{random}) = -0.007392078169007411$, $\mu(A_{random}) = \left \| A_{random} \right \|*\left \| {A_{random}}^{-1} \right \| = 171.57062069397406$

|     $A$ |         |         |         |         |         |         |         |         |         | $b$     |
| ------: | ------: | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- |
| 0.09310 | 0.46296 | 0.93137 | 0.30380 | 0.60630 | 0.90974 | 0.00426 | 0.19193 | 0.12714 | 0.98395 | 0.41040 |
| 0.24521 | 0.76891 | 0.47166 | 0.55561 | 0.76400 | 0.41916 | 0.42559 | 0.74468 | 0.95186 | 0.81468 | 0.93407 |
| 0.20463 | 0.51378 | 0.84973 | 0.84296 | 0.02374 | 0.44718 | 0.66388 | 0.61766 | 0.57209 | 0.25182 | 0.25237 |
| 0.88916 | 0.98856 | 0.61451 | 0.44720 | 0.89148 | 0.86907 | 0.50745 | 0.06848 | 0.86180 | 0.84522 | 0.49320 |
| 0.23916 | 0.23566 | 0.37235 | 0.87459 | 0.97991 | 0.58573 | 0.70257 | 0.17351 | 0.22382 | 0.82836 | 0.67732 |
| 0.17299 | 0.63587 | 0.46413 | 0.88649 | 0.38913 | 0.35721 | 0.93878 | 0.19617 | 0.65420 | 0.82861 | 0.62401 |
| 0.44414 | 0.05817 | 0.73251 | 0.30840 | 0.17337 | 0.26483 | 0.31740 | 0.64132 | 0.73144 | 0.53343 | 0.80028 |
| 0.43692 | 0.52223 | 0.08441 | 0.47346 | 0.94672 | 0.80371 | 0.70694 | 0.45602 | 0.69618 | 0.14082 | 0.10161 |
| 0.74979 | 0.91611 | 0.41144 | 0.98386 | 0.02433 | 0.70182 | 0.64097 | 0.78008 | 0.01748 | 0.49528 | 0.04442 |
| 0.75950 | 0.49040 | 0.62319 | 0.77167 | 0.47742 | 0.62423 | 0.76287 | 0.99692 | 0.64978 | 0.39911 | 0.30820 |
| 0.01054 | 0.00871 | 0.45547 | 0.58313 | 0.67816 | 0.75775 | 0.39740 | 0.58843 | 0.48111 | 0.13340 | 0.84128 |
| 0.16602 | 0.06466 | 0.78431 | 0.62658 | 0.43781 | 0.06728 | 0.47534 | 0.63883 | 0.59357 | 0.72091 | 0.19221 |

| $A_{symmetric}$ |         |         |         |         |         |         |         |         | $b$     |
| --------------: | ------: | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- |
|         4.32860 | 3.99913 | 2.72190 | 4.02301 | 3.14499 | 3.29613 | 2.77881 | 2.54551 | 3.25875 | 3.25499 |
|         3.99913 | 5.79533 | 3.67262 | 5.06622 | 3.95397 | 4.61251 | 3.89278 | 3.73887 | 3.98181 | 4.67136 |
|         2.72190 | 3.67262 | 3.48268 | 3.37672 | 2.65894 | 3.46967 | 2.79404 | 2.64362 | 3.62647 | 3.83958 |
|         4.02301 | 5.06622 | 3.37672 | 5.96422 | 4.08711 | 4.37998 | 3.29952 | 4.01039 | 4.01840 | 4.54352 |
|         3.14499 | 3.95397 | 2.65894 | 4.08711 | 4.05610 | 3.75951 | 2.54847 | 3.04612 | 2.99136 | 3.50605 |
|         3.29613 | 4.61251 | 3.46967 | 4.37998 | 3.75951 | 4.50313 | 3.09145 | 3.17113 | 3.77247 | 4.02348 |
|         2.77881 | 3.89278 | 2.79404 | 3.29952 | 2.54847 | 3.09145 | 3.25688 | 2.24767 | 2.72087 | 3.45720 |
|         2.54551 | 3.73887 | 2.64362 | 4.01039 | 3.04612 | 3.17113 | 2.24767 | 3.64560 | 3.16916 | 3.73490 |
|         3.25875 | 3.98181 | 3.62647 | 4.01840 | 2.99136 | 3.77247 | 2.72087 | 3.16916 | 5.07639 | 4.46737 |
|         3.25499 | 4.67136 | 3.83958 | 4.54352 | 3.50605 | 4.02348 | 3.45720 | 3.73490 | 4.46737 | 4.98484 |
|         2.42863 | 3.40900 | 2.42971 | 3.03193 | 2.97243 | 2.75708 | 2.48397 | 2.59751 | 2.22107 | 3.10237 |
|         2.79500 | 3.66512 | 2.88644 | 3.11504 | 2.74696 | 3.21662 | 2.82167 | 2.35331 | 2.87909 | 3.44315 |

###### Результаты

|            Метод            | Точное решение |    Якоби |                   Зайделя |     Зайделя с релаксацией | Cопряжённых градиентов |      Гаусса |
| :-------------------------: | -------------: | -------: | ------------------------: | ------------------------: | ---------------------: | ----------: |
|     Количество итераций     |              - | $\infty$ |                        56 |                        84 |                     14 |           - |
| Критерий окончания итераций |              - |        - | Малость нормы приближений | Малость нормы приближений |        Малость невязки |           - |
|            $x_1$            |     1.24386958 | $\infty$ |                5.07222390 |                2.53611195 |             1.24386957 |  1.24386958 |
|            $x_2$            |    -1.46857295 | $\infty$ |               0.064430212 |               -0.07782169 |            -1.46857295 | -1.46857295 |
|            $x_3$            |    -0.29223781 | $\infty$ |               0.026281931 |               -0.17580902 |            -0.29223781 | -0.29223781 |
|            $x_4$            |     1.10681103 | $\infty$ |               -6.48895878 |               -1.87528237 |             1.10681102 |  1.10681103 |
|            $x_5$            |     0.58006511 | $\infty$ |                5.17476138 |                0.68376892 |             0.58006511 |  0.58006511 |
|            $x_6$            |    -0.31909681 | $\infty$ |                11.2342668 |                2.00074065 |            -0.31909681 | -0.31909681 |
|            $x_7$            |    -0.76018098 | $\infty$ |               -8.91521041 |               -0.21629973 |            -0.76018099 | -0.76018098 |
|            $x_8$            |    -0.97736241 | $\infty$ |                 1.7939253 |                 -1.552086 |            -0.97736241 | -0.97736241 |
|            $x_9$            |     0.75454575 | $\infty$ |                633.812509 |               15.83035935 |             0.75454575 |  0.75454575 |
|          $x_{10}$           |    -0.62774438 | $\infty$ |                   2.68475 |              -12.26533549 |            -0.62774438 | -0.62774438 |
|          $x_{11}$           |     -0.2649922 | $\infty$ |                  0.632206 |               -3.45405884 |             -0.2649922 |  -0.2649922 |
|          $x_{12}$           |     1.98558713 | $\infty$ |                676.603626 |                2.21005337 |             1.98558712 |  1.98558713 |

Все методы вычислялись на симметричной матрице, метод Якоби не дал ответа, так как не выполнялись условия накладываемые на матрицу, которые описаны выше.

### <u>Гильбертова матрица</u>

Результаты для Гильбертовой матрицы имеют большие ошибки, так как она плохо обусловлена и имеет относительно большую размерность.$det(A_{Hilbert}) \approx 0.0000000000000000000000000000000000000000000000000000000000000000000000000000025505547367892783$$\mu(A_{Hilbert}) = \left \| A_{Hilbert} \right \|*\left \| {A_{Hilbert}}^{-1} \right \| = 18,114,388,365,948,876$

|     $A$ |         |         |         |         |         |         |         |         |         |         |         | $b$     |
| ------: | ------: | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- |
| 1.00000 | 0.50000 | 0.33333 | 0.25000 | 0.20000 | 0.16667 | 0.14286 | 0.12500 | 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.97844 |
| 0.50000 | 0.33333 | 0.25000 | 0.20000 | 0.16667 | 0.14286 | 0.12500 | 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.18721 |
| 0.33333 | 0.25000 | 0.20000 | 0.16667 | 0.14286 | 0.12500 | 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.14532 |
| 0.25000 | 0.20000 | 0.16667 | 0.14286 | 0.12500 | 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.95626 |
| 0.20000 | 0.16667 | 0.14286 | 0.12500 | 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.06250 | 0.64579 |
| 0.16667 | 0.14286 | 0.12500 | 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.06250 | 0.05882 | 0.24603 |
| 0.14286 | 0.12500 | 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.06250 | 0.05882 | 0.05556 | 0.23098 |
| 0.12500 | 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.06250 | 0.05882 | 0.05556 | 0.05263 | 0.17866 |
| 0.11111 | 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.06250 | 0.05882 | 0.05556 | 0.05263 | 0.05000 | 0.62681 |
| 0.10000 | 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.06250 | 0.05882 | 0.05556 | 0.05263 | 0.05000 | 0.04762 | 0.74929 |
| 0.09091 | 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.06250 | 0.05882 | 0.05556 | 0.05263 | 0.05000 | 0.04762 | 0.04545 | 0.37816 |
| 0.08333 | 0.07692 | 0.07143 | 0.06667 | 0.06250 | 0.05882 | 0.05556 | 0.05263 | 0.05000 | 0.04762 | 0.04545 | 0.04348 | 0.02893 |

| $ A_{symmetric}$ |         |         |         |         |         |         |         |         |         |         |         | $b$     |
| ---------------: | ------: | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- |
|          1.56498 | 0.92308 | 0.67582 | 0.53944 | 0.45145 | 0.38940 | 0.34302 | 0.30690 | 0.27792 | 0.25409 | 0.23414 | 0.21716 | 1.76640 |
|          0.92308 | 0.57089 | 0.42857 | 0.34762 | 0.29425 | 0.25598 | 0.22701 | 0.20421 | 0.18575 | 0.17047 | 0.15759 | 0.14657 | 1.13524 |
|          0.67582 | 0.42857 | 0.32600 | 0.26667 | 0.22708 | 0.19845 | 0.17661 | 0.15934 | 0.14528 | 0.13360 | 0.12371 | 0.11524 | 0.87851 |
|          0.53944 | 0.34762 | 0.26667 | 0.21933 | 0.18750 | 0.16434 | 0.14660 | 0.13250 | 0.12100 | 0.11142 | 0.10329 | 0.09631 | 0.72909 |
|          0.45145 | 0.29425 | 0.22708 | 0.18750 | 0.16074 | 0.14118 | 0.12614 | 0.11417 | 0.10438 | 0.09620 | 0.08926 | 0.08328 | 0.62818 |
|          0.38940 | 0.25598 | 0.19845 | 0.16434 | 0.14118 | 0.12420 | 0.11111 | 0.10067 | 0.09211 | 0.08496 | 0.07887 | 0.07363 | 0.55423 |
|          0.34302 | 0.22701 | 0.17661 | 0.14660 | 0.12614 | 0.11111 | 0.09950 | 0.09023 | 0.08261 | 0.07624 | 0.07082 | 0.06614 | 0.49716 |
|          0.30690 | 0.20421 | 0.15934 | 0.13250 | 0.11417 | 0.10067 | 0.09023 | 0.08187 | 0.07500 | 0.06925 | 0.06435 | 0.06012 | 0.45150 |
|          0.27792 | 0.18575 | 0.14528 | 0.12100 | 0.10438 | 0.09211 | 0.08261 | 0.07500 | 0.06874 | 0.06349 | 0.05902 | 0.05516 | 0.41400 |
|          0.25409 | 0.17047 | 0.13360 | 0.11142 | 0.09620 | 0.08496 | 0.07624 | 0.06925 | 0.06349 | 0.05866 | 0.05455 | 0.05099 | 0.38255 |
|          0.23414 | 0.15759 | 0.12371 | 0.10329 | 0.08926 | 0.07887 | 0.07082 | 0.06435 | 0.05902 | 0.05455 | 0.05073 | 0.04743 | 0.35575 |
|          0.21716 | 0.14657 | 0.11524 | 0.09631 | 0.08328 | 0.07363 | 0.06614 | 0.06012 | 0.05516 | 0.05099 | 0.04743 | 0.04436 | 0.33260 |

###### Результаты

| Метод                       |      Точное решение |    Якоби |                   Зайделя |     Зайделя с релаксацией |    Cопряжённых градиентов |       Гаусса |
| --------------------------- | ------------------: | -------: | ------------------------: | ------------------------: | ------------------------: | -----------: |
| Количество итераций         |                   - | $\infty$ |                   398,143 |                   760,067 |                         7 |            - |
| Критерий окончания итераций |                   - |        - | Малость нормы приближений | Малость нормы приближений | Малость нормы приближений |            - |
| $x_1$                       |        46,781,720.8 | $\infty$ |               17.81627383 |           -3,583.32097743 |               30.78958822 |   863.078119 |
| $x_2$                       |         849,034,980 | $\infty$ |              -91.70662594 |            91,128.5186219 |             -214.16477372 |     191.0547 |
| $x_3$                       |     181,684,671,000 | $\infty$ |               57.41217542 |         -481,556.34841693 |              220.24024254 |  980,106.815 |
| $x_4$                       |     447,964,920,000 | $\infty$ |               45.41660631 |           634,810.5275951 |              160.16744491 |   518,299.37 |
| $x_5$                       |  17,765,826,500,000 | $\infty$ |               20.08695618 |          390,529.52021387 |                 9.5460452 | 3,125,122.47 |
| $x_6$                       |   7,351,576,700,000 | $\infty$ |                 2.7947155 |         -474,326.46996043 |              -94.26656176 | 2,369,739.56 |
| $x_7$                       | 213,749,747,000,000 | $\infty$ |               -6.48350621 |         -470,036.33912928 |              -132.4074806 | 2,395,753.35 |
| $x_8$                       |  84,020,107,000,000 | $\infty$ |              -10.46428639 |       -1,280,820.31120389 |             -118.56941313 |   478,289.70 |
| $x_9$                       | 447,139,526,000,000 | $\infty$ |              -11.35370314 |        1,242,462.62332825 |               -70.5986475 |    34,288.02 |
| $x_{10}$                    |  25,426,524,000,000 | $\infty$ |              -10.57752072 |        1,554,802.01113041 |               -3.02426836 | 16,908,362.2 |
| $x_{11}$                    | 134,524,619,000,000 | $\infty$ |               -8.98870386 |         -639,258.44737977 |               73.89735875 |  851,236,572 |
| $x_{12}$                    |   4,109,452,800,000 | $\infty$ |               -7.07703951 |         -568,582.92197412 |              153.43207369 |   530,440.05 |

Все методы вычислялись на симметричной матрице, метод Якоби не дал ответа, так как не выполнялись условия накладываемые на матрицу, которые описаны выше.

//TODO:

// Объяснить использование именно симметричных матриц там, где они используются

// (Не обязательно) Объяснить неточность решений обоими методами Зайделя для случайной матрицы
// неоптимальным критерием окончания итераций (возможно, лучше предоставить решение только с невязкой и
// объяснить это)